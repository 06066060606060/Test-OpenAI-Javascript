<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Document</title>
</head>
<body>
  <div class="flex flex-col justify-center py-8">
    <h1 class="font-bold text-2xl mx-auto pb-8">
      OpenAI Test
    </h1>
    <div class="flex flex-row-reverse">
      <input type="text" id="myapi" class="border px-2" value="" placeholder="sk-........"/>
    <label class="font-bold">ApiKey:</label>
  </div>
    <div class="flex flex-col mx-8">
      <label class="font-bold">Prompt:</label>
      <input type="text" id="text" class="border px-2" value="Extract the requirements for this job offer as a list." />
     
    </div>
    <div class="flex mx-8">
      <button id="button" class="bg-gray-500  my-2 py-2 rounded hover:bg-slate-400 px-2" onclick="runTextAnalysis()">Analyse Text</button> 
      <button id="button" class="bg-gray-500  my-2 py-2 rounded hover:bg-slate-400 mx-4 px-2" onclick="runImageGenerate()">Generate Image from the prompt</button>
    </div>

<div class="flex mx-8 justify-center">
  <textarea id="thetext" name="" rows="8" cols="100" class="border">
We are seeking a PHP web developer to join our team. The ideal candidate will have experience with PHP, MySQL, HTML, CSS, and JavaScript. They will be responsible for developing and managing web applications and working with a team of developers to create high-quality and innovative software. The salary for this position is negotiable and will be based on experience.
  </textarea>
</div>
<div class="flex mx-8 justify-center pt-4">
  <textarea id="resultText" name="" rows="8" cols="100" class="border">
  </textarea>
</div>
    <div class="flex h-[600px] w-auto pt-4 mx-auto">
      <img id="resultDiv" src="" class="w-fit"></img>
    </div>
  </div>
</body>
<script>
read();
function read(){
var xmlhttp, text;
xmlhttp = new XMLHttpRequest();
xmlhttp.open('GET', 'config.conf', false);
xmlhttp.send();
document.getElementById("myapi").value = xmlhttp.responseText; 
}



  //function using openai image generation api
  function runImageGenerate() {
    var text = document.getElementById("text").value;
    var url = "https://api.openai.com/v1/images/generations";
    var data = {
      "prompt": text,
      "n": 1,
      "size": "512x512",
    };
    var xhr = new XMLHttpRequest();
    xhr.open("POST", url, true);
    var myapikey = document.getElementById("myapi").value;
    xhr.setRequestHeader("Content-Type", "application/json");
//authorization bearer token
    xhr.setRequestHeader("Authorization", "Bearer " + myapikey);
    xhr.onreadystatechange = function () {
      if (xhr.readyState == 4 && xhr.status == 200) {
        var json = JSON.parse(xhr.responseText);
        document.getElementById("resultDiv").src = json.data[0].url;
        console.log(json.data[0].url);
      }
    }
    xhr.send(JSON.stringify(data));

  }


  function runTextAnalysis() {
    var text = document.getElementById("text").value + " " + document.getElementById("thetext").value;
    var url = "https://api.openai.com/v1/completions";
    var data = {
      "prompt": text,
      "model": "text-davinci-002",
      "max_tokens": 50,
    };
    var xhr = new XMLHttpRequest();
    xhr.open("POST", url, true);
    var myapikey = document.getElementById("myapi").value;
    xhr.setRequestHeader("Content-Type", "application/json");
//authorization bearer token
    xhr.setRequestHeader("Authorization", "Bearer " + myapikey);
    xhr.onreadystatechange = function () {
      if (xhr.readyState == 4 && xhr.status == 200) {
        var json = JSON.parse(xhr.responseText);
        document.getElementById("resultText").innerHTML = json.choices[0].text;
        console.log(json.choices[0].text);
      }
    }
    xhr.send(JSON.stringify(data));

  }

</script>

</html>